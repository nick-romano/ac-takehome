(this["webpackJsonprecord-shelves-app"]=this["webpackJsonprecord-shelves-app"]||[]).push([[0],{103:function(e,t,n){},110:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n(0),r=n.n(a),s=n(10),d=n.n(s),i=(n(103),n(7)),l=n(13),o=function(e,t){switch(t.type){case"setUser":return Object(i.a)(Object(i.a)({},e),{},{user:t.user});default:throw new Error("unknown action dispatched to admin reducer")}},j={user:"blacklight"},u=Object(a.createContext)(j),b=function(e){var t=e.children,n=Object(a.useReducer)(o,j),r=Object(l.a)(n,2),s=r[0],d=r[1];return Object(c.jsx)(u.Provider,{value:Object(i.a)(Object(i.a)({},s),{},{dispatch:d}),children:t})},h=n(47),O=n(27),p=0,x=function(e,t){var n;switch(t.type){case"createShelf":var c="shelf-".concat(p);return p++,Object(i.a)(Object(i.a)({},e),{},Object(O.a)({},c,{id:c,name:t.name,records:[]}));case"deleteShelf":return Object.entries(e).reduce((function(e,n){var c=Object(l.a)(n,2),a=c[0],r=c[1];return a!==t.id&&(e[a]=r),e}),{});case"renameShelf":return Object(i.a)(Object(i.a)({},e),{},Object(O.a)({},t.id,Object(i.a)(Object(i.a)({},e[t.id]),{},{name:t.name})));case"addRecordToShelf":return Object(i.a)(Object(i.a)({},e),{},Object(O.a)({},t.shelfId,Object(i.a)(Object(i.a)({},e[t.shelfId]),{},{records:e[t.shelfId].records.concat(t.recordId)})));case"removeRecordFromShelf":return Object(i.a)(Object(i.a)({},e),{},Object(O.a)({},t.shelfId,Object(i.a)(Object(i.a)({},e[t.shelfId]),{},{records:e[t.shelfId].records.filter((function(e){return e!==t.recordId}))})));case"reorderInShelf":var a=Object(h.a)(e[t.shelfId].records),r=a.splice(t.oldIndex,1),s=Object(l.a)(r,1)[0];return a.splice(t.newIndex,0,s),Object(i.a)(Object(i.a)({},e),{},Object(O.a)({},t.shelfId,Object(i.a)(Object(i.a)({},e[t.shelfId]),{},{records:a})));case"moveBetweenShelves":var d=Object(h.a)(e[t.newShelf].records);return d.splice(t.newIndex,0,e[t.oldShelf].records[t.oldIndex]),Object(i.a)(Object(i.a)({},e),{},(n={},Object(O.a)(n,t.oldShelf,Object(i.a)(Object(i.a)({},e[t.oldShelf]),{},{records:e[t.oldShelf].records.filter((function(e,n){return n!==t.oldIndex}))})),Object(O.a)(n,t.newShelf,Object(i.a)(Object(i.a)({},e[t.newShelf]),{},{records:d})),n));case"resetState":return f;default:throw new Error}},f={},m=Object(a.createContext)(f),v=function(e){var t=e.children,n=Object(a.useReducer)(x,f),r=Object(l.a)(n,2),s=r[0],d=r[1];return Object(c.jsx)(m.Provider,{value:{shelves:s,dispatch:d},children:t})},g=function(e,t){switch(t.type){case"setAdminMenuOpen":return Object(i.a)(Object(i.a)({},e),{},{adminMenuOpen:t.menuOpen});case"setSideMenuSelection":return Object(i.a)(Object(i.a)({},e),{},{sideMenuSelection:t.id});case"setShelvesMenuExpanded":return Object(i.a)(Object(i.a)({},e),{},{shelvesMenuExpanded:t.shelvesMenuExpanded});case"setAddShelfModalOpen":return Object(i.a)(Object(i.a)({},e),{},{addShelfModalOpen:t.addShelfModalOpen});case"setNextPage":return Object(i.a)(Object(i.a)({},e),{},{nextPage:t.nextPage});case"setChangeUserModalOpen":return Object(i.a)(Object(i.a)({},e),{},{changeUserModalOpen:t.changeUserModalOpen});default:throw new Error("Unknown action type provided to admin reducer")}},S={adminMenuOpen:!1,shelvesMenuExpanded:!0,sideMenuSelection:void 0,addShelfModalOpen:!1,perPage:25,nextPage:void 0,changeUserModalOpen:!1},y=Object(a.createContext)(S),C=function(e){var t=e.children,n=Object(a.useReducer)(g,S),r=Object(l.a)(n,2),s=r[0],d=r[1];return Object(c.jsx)(y.Provider,{value:Object(i.a)(Object(i.a)({},s),{},{dispatch:d}),children:t})},I=function(e){var t=e.children;return Object(c.jsx)(b,{children:Object(c.jsx)(C,{children:Object(c.jsx)(v,{children:t})})})},M=n(157),w=n(146),k=n(51),P=n(144),E=n(80),R=n(111),U=n(138),N=n(139),A=n(140),B=n(141),F=n(142),T=n(162),L=n(159),D=n(145);function H(e){var t=e.record,n=e.shelf,a=e.shelves,r=e.dispatch;return Object(c.jsx)(R.a,{children:Object(c.jsxs)(U.a,{style:{width:"260px"},children:[Object(c.jsxs)(N.a,{children:[Object(c.jsxs)("p",{children:["Title: ",t.title]}),Object(c.jsxs)("p",{children:["Artist(s):",t.artists.join(", ")]}),Object(c.jsxs)("p",{children:["Label: ",t.label]}),Object(c.jsxs)("p",{children:["Formats: ",t.formats.join(", ")]})]}),Object(c.jsx)(A.a,{children:n?Object(c.jsx)(B.a,{onClick:function(){return r({type:"removeRecordFromShelf",shelfId:n.id,recordId:t.id})},children:"Remove"}):Object.keys(a).length?Object(c.jsxs)(F.a,{style:{minWidth:"120px"},children:[Object(c.jsx)(T.a,{children:"Add to shelf"}),Object(c.jsx)(L.a,{"data-testid":"add-shelf",value:"",onChange:function(e){return r({type:"addRecordToShelf",shelfId:e.target.value,recordId:t.id})},children:Object.values(a).map((function(e){return Object(c.jsx)(D.a,{value:e.id,children:e.name},e.id)}))})]}):null})]})},t.id)}function z(e){var t=e.handleScroll,n=e.records,a=e.shelves,r=e.dispatch;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h2",{children:"Records"}),Object(c.jsx)(P.a,{style:{backgroundColor:"#f5f5f5",height:"calc(100vh - 12rem)",overflow:"scroll"},component:E.a,elevation:0,onScroll:t,children:Object(c.jsx)(w.a,{container:!0,children:n.map((function(e){return Object(c.jsx)(w.a,{item:!0,xs:6,sm:6,md:4,children:Object(c.jsx)(H,{record:e,shelves:a,dispatch:r})},e.id)}))})})]})}var J=n(147),_=n(148),W=n(149),q=n(150),G=n(151),K=n(72),Q=n.n(K),V=n(76),X=n.n(V),Y=n(75),Z=n.n(Y),$=n(74),ee=n.n($),te=n(73),ne=n.n(te),ce=n(77),ae=n.n(ce),re=function(){return{adminContext:Object(a.useContext)(u),layoutContext:Object(a.useContext)(y),catalogContext:Object(a.useContext)(m)}},se=n(4),de=Object(J.a)((function(e){return{root:{width:"100%",height:"100%"},nested:{paddingLeft:e.spacing(4)},listItem:{borderRadius:40,margin:e.spacing(1)},selected:{background:"#add8e647"}}})),ie=function(){var e=re(),t=e.catalogContext,n=e.layoutContext,a=de(),r=function(e){var t=e.id;n.dispatch({type:"setSideMenuSelection",id:t})};return Object(c.jsxs)(P.a,{component:"nav","aria-labelledby":"nested-list-subheader",className:a.root,subheader:Object(c.jsx)(_.a,{component:"div",id:"nested-list-subheader",children:"Catalog"}),children:[Object(c.jsxs)(R.a,{button:!0,className:Object(se.a)(!n.sideMenuSelection&&a.selected,a.listItem),onClick:r,children:[Object(c.jsx)(W.a,{children:Object(c.jsx)(Q.a,{})}),Object(c.jsx)(q.a,{primary:"Records"})]}),Object(c.jsxs)(R.a,{button:!0,onClick:function(){n.dispatch({type:"setShelvesMenuExpanded",shelvesMenuExpanded:!n.shelvesMenuExpanded})},className:Object(se.a)(a.listItem),children:[Object(c.jsx)(W.a,{children:Object(c.jsx)(ne.a,{})}),Object(c.jsx)(q.a,{primary:"Shelves"}),n.shelvesMenuExpanded?Object(c.jsx)(ee.a,{}):Object(c.jsx)(Z.a,{})]}),Object(c.jsx)(G.a,{in:n.shelvesMenuExpanded,timeout:"auto",unmountOnExit:!0,children:Object(c.jsxs)(P.a,{component:"div",disablePadding:!0,children:[Object.values(t.shelves).map((function(e){return Object(c.jsxs)(R.a,{button:!0,className:Object(se.a)(n.sideMenuSelection===e.id&&a.selected,a.nested,a.listItem),onClick:function(){return r(e)},children:[Object(c.jsx)(W.a,{children:Object(c.jsx)(X.a,{})}),Object(c.jsx)(q.a,{primary:e.name})]},e.id)})),Object(c.jsxs)(R.a,{button:!0,className:Object(se.a)(a.nested,a.listItem),onClick:function(){n.dispatch({type:"setAddShelfModalOpen",addShelfModalOpen:!0})},children:[Object(c.jsx)(W.a,{children:Object(c.jsx)(ae.a,{})}),Object(c.jsx)(q.a,{primary:"New Shelf"})]},"add")]})})]})},le=n(158),oe=n(143);function je(e){var t=e.records,n=e.shelf,r=e.dispatch,s=n.records.map((function(e){return t.find((function(t){return e===t.id}))})),d=Object(a.useState)(!1),o=Object(l.a)(d,2),j=o[0],u=o[1],b=Object(a.useState)(n.name),h=Object(l.a)(b,2),O=h[0],p=h[1],x=Object(a.useCallback)((function(){r({type:"renameShelf",id:n.id,name:O}),u(!1)}),[r,O,n]);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(le.a,{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[j?Object(c.jsx)(oe.a,{variant:"filled",value:O,onChange:function(e){return p(e.target.value)},onBlur:x,onEnter:x}):Object(c.jsx)("h3",{onClick:function(){return u(!0)},style:{cursor:"pointer"},children:n.name}),Object(c.jsx)(B.a,{variant:"outlined",onClick:function(){return r({type:"deleteShelf",id:n.id})},style:{marginLeft:"1rem"},children:"Remove"})]}),Object(c.jsx)(R.a,{style:{backgroundColor:"#f5f5f5",minHeight:"10rem",marginBottom:"1rem"},children:Object(c.jsx)(k.c,{droppableId:n.id,direction:"horizontal",children:function(e,t){return Object(c.jsxs)(P.a,{ref:e.innerRef,style:{display:"flex",flexDirection:"row",overflow:"scroll"},children:[s.length?s.map((function(e,t){return Object(c.jsx)(k.b,{draggableId:e.id,index:t,children:function(t,a){return Object(c.jsx)("span",Object(i.a)(Object(i.a)(Object(i.a)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:Object(c.jsx)(H,{record:e,shelf:n,dispatch:r})}),e.id)}},e.id)})):Object(c.jsx)("p",{children:"No records in shelf"}),e.placeholder]})}})},n.id)]})}var ue=n(152),be=n(52),he=Object(J.a)((function(e){return{root:{padding:e.spacing(2)},userMenuButtonItem:{textAlign:"right"},userMenuButton:{fontSize:10}}})),Oe=function(e){var t=e.title,n=re().layoutContext,a=he();return Object(c.jsx)(ue.a,{position:"static",className:a.root,children:Object(c.jsxs)(w.a,{container:!0,align:"flex-end",children:[Object(c.jsx)(w.a,{item:!0,xs:10,children:Object(c.jsx)(be.a,{variant:"h5",children:t})}),Object(c.jsx)(w.a,{item:!0,xs:2,className:a.userMenuButtonItem,children:Object(c.jsx)(B.a,{variant:"contained",className:a.userMenuButton,onClick:function(){n.dispatch({type:"setChangeUserModalOpen",changeUserModalOpen:!0})},children:"Change User"})})]})})},pe=n(161),xe=n(156),fe=n(155),me=n(154),ve=n(153),ge=n(21);function Se(e){e.records,e.shelves;var t=e.dispatch,n=Object(a.useState)(!1),r=Object(l.a)(n,2),s=r[0],d=r[1],i=Object(a.useState)(""),o=Object(l.a)(i,2),j=o[0],u=o[1],b=Object(a.useCallback)((function(e){return e.preventDefault(),t({type:"createShelf",name:j}),d(!1),u(""),!1}),[t,j]);return Object(c.jsx)(c.Fragment,{children:s?Object(c.jsxs)("form",{onSubmit:b,style:{marginTop:"1rem"},children:[Object(c.jsx)(oe.a,{inputProps:{"data-testid":"add-shelf"},variant:"outlined",value:j,onChange:function(e){return u(e.target.value)}}),Object(c.jsx)(B.a,{type:"submit",variant:"contained",style:{marginLeft:"1rem"},children:"Submit"})]}):Object(c.jsx)(B.a,{variant:"contained",onClick:function(){return d(!0)},children:"Add Shelf"})})}function ye(e){var t=e.records,n=re(),a=n.layoutContext,r=n.catalogContext,s=Object(ge.a)(),d=Object(ve.a)(s.breakpoints.down("xs")),i=function(){a.dispatch({type:"setAddShelfModalOpen",addShelfModalOpen:!1})};return Object(c.jsx)("div",{children:Object(c.jsxs)(pe.a,{fullScreen:d,open:a.addShelfModalOpen,onClose:i,"aria-labelledby":"responsive-dialog-title",children:[Object(c.jsx)(me.a,{id:"responsive-dialog-title",children:"Press the button below to add a shelf"}),Object(c.jsx)(fe.a,{children:Object(c.jsx)(Se,{records:t,dispatch:r.dispatch})}),Object(c.jsx)(xe.a,{children:Object(c.jsx)(B.a,{autoFocus:!0,onClick:i,color:"primary",children:"Close"})})]})})}function Ce(){var e=re(),t=e.layoutContext,n=e.adminContext,s=e.catalogContext,d=t.dispatch,i=n.dispatch,o=s.dispatch,j=Object(a.useState)(""),u=Object(l.a)(j,2),b=u[0],h=u[1],O=Object(ge.a)(),p=Object(ve.a)(O.breakpoints.down("xs")),x=r.a.useCallback((function(){d({type:"setChangeUserModalOpen",changeUserModalOpen:!1})}),[d]),f=r.a.useCallback((function(e){e.preventDefault(),o({type:"resetState"}),i({type:"setUser",user:b})}),[i,b,o]);return Object(c.jsx)("div",{children:Object(c.jsxs)(pe.a,{fullScreen:p,open:t.changeUserModalOpen,onClose:x,"aria-labelledby":"responsive-dialog-title",children:[Object(c.jsx)(me.a,{id:"responsive-dialog-title",children:"Change User"}),Object(c.jsx)(fe.a,{children:Object(c.jsxs)("form",{onSubmit:f,style:{marginTop:"1rem"},children:[Object(c.jsx)(oe.a,{inputProps:{"data-testid":"change-user"},variant:"outlined",value:b,onChange:function(e){return h(e.target.value)}}),Object(c.jsx)(B.a,{type:"submit",variant:"contained",style:{marginLeft:"1rem"},children:"Submit"})]})}),Object(c.jsx)(xe.a,{children:Object(c.jsx)(B.a,{autoFocus:!0,onClick:x,color:"primary",children:"Close"})})]})})}function Ie(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),n=t[0],r=t[1],s=re(),d=s.catalogContext,i=s.layoutContext,o=s.adminContext,j=d.shelves,u=d.dispatch,b=i.dispatch,O=i.perPage,p=o.user,x=Object(a.useCallback)((function(e){var t=e.source,n=e.destination;n&&(t.droppableId===n.droppableId?u({type:"reorderInShelf",shelfId:t.droppableId,oldIndex:t.index,newIndex:n.index}):u({type:"moveBetweenShelves",oldShelf:t.droppableId,newShelf:n.droppableId,oldIndex:t.index,newIndex:n.index}))}),[u]);Object(a.useEffect)((function(){r([])}),[p]);var f=Object(a.useCallback)((function(e){fetch(e).then((function(e){return e.json()})).then((function(e){r((function(t){return[].concat(Object(h.a)(t),Object(h.a)(e.releases.map((function(e){var t,n,c,a=e.id,r=e.basic_information;return{id:"".concat(a),title:r.title,formats:r.formats.map((function(e){return e.name})),label:null!==(t=null===(n=r.labels)||void 0===n||null===(c=n[0])||void 0===c?void 0:c.name)&&void 0!==t?t:"",artists:r.artists.map((function(e){return e.name})),date:r.year}}))))})),b({type:"setNextPage",nextPage:e.pagination.urls.next})}))}),[b]);return Object(a.useEffect)((function(){f("https://api.discogs.com/users/".concat(p,"/collection/folders/0/releases?page=1&per_page=").concat(O))}),[f,p,O]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(Oe,{title:"Record Shelves App"}),Object(c.jsx)(M.a,{children:Object(c.jsxs)(w.a,{container:!0,spacing:3,children:[Object(c.jsx)(w.a,{item:!0,xs:3,style:{textAlign:"left"},children:Object(c.jsx)(ie,{})}),Object(c.jsx)(w.a,{item:!0,xs:9,children:i.sideMenuSelection?Object(c.jsx)(k.a,{onDragEnd:x,children:Object.values(j).map((function(e){return Object(c.jsx)(je,{records:n,shelf:e,dispatch:u},e.id)}))}):Object(c.jsx)(z,{records:n,shelves:j,dispatch:u,handleScroll:function(e){e.target.scrollHeight-e.target.scrollTop===e.target.clientHeight&&i.nextPage&&f(i.nextPage)}})})]})}),Object(c.jsx)(ye,{records:n}),Object(c.jsx)(Ce,{})]})}function Me(){return Object(c.jsx)(I,{children:Object(c.jsx)(Ie,{})})}d.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(Me,{})}),document.getElementById("root"))}},[[110,1,2]]]);
//# sourceMappingURL=main.ae923792.chunk.js.map